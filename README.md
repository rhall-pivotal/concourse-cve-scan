# concourse-cve-scan

This repository is an example of a [Concourse](https://concourse-ci.org/) pipeline that utilizes a `scan` task. This task allows a TAS Contributor to scan their Git repository for CVEs with [syft](https://github.com/anchore/syft) and [grype](https://github.com/anchore/grype). There is also an input that enables [TAS-CVE](https://github.com/pivotal/tas-cve) to upload your results to [Dependency-Track](https://dependencytrack-dev.apps.dhaka.cf-app.com/). 

Utilizing the included [`scan`](https://github.com/rhall-pivotal/concourse-cve-scan/tree/main/tasks/scan) task enables TAS Contributors to check for CVEs earlier in their release processes.

## Contents:

* ci/ci.yml - A pipeline definition utilizing 3 resources and 1 task that can be customized using 6 inputs:
  * L18: `uri:` - Github URI of the Github Repo to be scanned.
  * L19: `branch:` - Name of the Branch within the repo to be scanned.
  * L33: `DRY_RUN:` - Disables the `tas-cve uploadBom` step when configured as `true`.  
  * L34: `GRYPE_FAILURE_LEVEL:` - Sets the severity threshold for `grype` to fail on detected CVEs.
    * Must be configured as: [`none` | `negligible` | `low` | `medium` | `high` | `critical`]
  * L35: `RELEASE_NAME` - Name of the project in Dependency-Track that your results will upload to.
  * L36: `RELEASE_VERSION` -  Version of the project in Dependency-Track that your results will upload to.
 
* tasks/scan.yml - The task definition for the `scan` task. This is ready for consumption using the `params` & `inputs` from the CI.

* tasks/scan.sh - The script definition for the `scan` task. This is ready for consumption with the task definition.

* images/slingshot-scanner - The image definiton for the docker image used for the scan task. Pre-installs `syft`, `grype`, and some other basic Linux tooling.

## Getting Help

Reach out to [#TAS-Slingshots](https://vmware.slack.com/archives/C05J220TM34) for assistance in implementing the Scan task in your Concourse pipeline!
